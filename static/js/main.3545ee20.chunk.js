(this.webpackJsonppatientor=this.webpackJsonppatientor||[]).push([[0],{263:function(e,a,t){e.exports=t(440)},440:function(e,a,t){"use strict";t.r(a);var n,r,l=t(0),c=t.n(l),i=t(61),o=t.n(i),s=(t(267),t(29)),u=t.n(s),d=t(22),m=t(42),p=t.n(m),h=t(86),E=t(54),v=t(450),g=t(462),b=t(458),f=t(451),C={apiBaseUrl:"https://patientor-backend.ahojukka5.com/api"},y=t(74),k=t(44),O={patients:{},diagnoses:{}},D=Object(l.createContext)([O,function(){return O}]),H=function(){return Object(l.useContext)(D)},S=function(e){return{type:"ADD_PATIENT",payload:e}},w=t(457),j=t(453),N=t(461),F=t(460),L=t(25),T=t(454),x=t(456),I=function(e){var a=e.name,t=e.label,n=e.options;return c.a.createElement(T.a.Field,null,c.a.createElement("label",null,t),c.a.createElement(L.b,{as:"select",name:a,className:"ui dropdown"},n.map((function(e){return c.a.createElement("option",{key:e.value,value:e.value},e.label||e.value)}))))},R=function(e){var a=e.field,t=e.label,n=e.placeholder;return c.a.createElement(T.a.Field,null,c.a.createElement("label",null,t),c.a.createElement(L.b,Object.assign({placeholder:n},a)),c.a.createElement("div",{style:{color:"red"}},c.a.createElement(L.a,{name:a.name})))};!function(e){e.Male="male",e.Female="female",e.Other="other"}(n||(n={})),function(e){e[e.Healthy=0]="Healthy",e[e.LowRisk=1]="LowRisk",e[e.HighRisk=2]="HighRisk",e[e.CriticalRisk=3]="CriticalRisk"}(r||(r={}));var Y=[{value:n.Male,label:"Male"},{value:n.Female,label:"Female"},{value:n.Other,label:"Other"}],A=function(e){var a=e.onSubmit,t=e.onCancel;return c.a.createElement(L.d,{initialValues:{name:"",ssn:"",dateOfBirth:"",occupation:"",gender:n.Other},onSubmit:a,validate:function(e){var a={};return e.name||(a.name="Field is required"),e.ssn||(a.ssn="Field is required"),e.dateOfBirth||(a.dateOfBirth="Field is required"),e.occupation||(a.occupation="Field is required"),a}},(function(e){var a=e.isValid,n=e.dirty;return c.a.createElement(L.c,{className:"form ui"},c.a.createElement(L.b,{label:"Name",placeholder:"Name",name:"name",component:R}),c.a.createElement(L.b,{label:"Social Security Number",placeholder:"SSN",name:"ssn",component:R}),c.a.createElement(L.b,{label:"Date Of Birth",placeholder:"YYYY-MM-DD",name:"dateOfBirth",component:R}),c.a.createElement(L.b,{label:"Occupation",placeholder:"Occupation",name:"occupation",component:R}),c.a.createElement(I,{label:"Gender",name:"gender",options:Y}),c.a.createElement(F.a,null,c.a.createElement(F.a.Column,{floated:"left",width:5},c.a.createElement(b.a,{type:"button",onClick:t,color:"red"},"Cancel")),c.a.createElement(F.a.Column,{floated:"right",width:5},c.a.createElement(b.a,{type:"submit",floated:"right",color:"green",disabled:!n||!a},"Add"))))}))},B=function(e){var a=e.modalOpen,t=e.onClose,n=e.onSubmit,r=e.error;return c.a.createElement(j.a,{open:a,onClose:t,centered:!1,closeIcon:!0},c.a.createElement(j.a.Header,null,"Add a new patient"),c.a.createElement(j.a.Content,null,r&&c.a.createElement(N.a,{inverted:!0,color:"red"},"Error: ".concat(r)),c.a.createElement(A,{onSubmit:n,onCancel:t})))},q=t(464),M=["The patient is in great shape","The patient has a low risk of getting sick","The patient has a high risk of getting sick","The patient has a diagnosed condition"],_=function(e){var a=e.rating,t=e.showText;return c.a.createElement("div",{className:"health-bar"},c.a.createElement(q.a,{icon:"heart",disabled:!0,rating:4-a,maxRating:4}),t?c.a.createElement("p",null,M[a]):null)},G=function(){var e=H(),a=Object(d.a)(e,2),t=a[0].patients,n=a[1],r=Object(E.f)(),l=c.a.useState(!1),i=Object(d.a)(l,2),o=i[0],s=i[1],m=c.a.useState(),h=Object(d.a)(m,2),g=h[0],f=h[1],y=function(){s(!1),f(void 0)},k=function(e){return function(){r.push("/patients/".concat(e.id))}};return c.a.createElement("div",{className:"App"},c.a.createElement(v.a,{textAlign:"center"},c.a.createElement("h3",null,"Patient list")),c.a.createElement(w.a,{celled:!0,selectable:!0,unstackable:!0},c.a.createElement(w.a.Header,null,c.a.createElement(w.a.Row,null,c.a.createElement(w.a.HeaderCell,null,"Name"),c.a.createElement(w.a.HeaderCell,null,"Gender"),c.a.createElement(w.a.HeaderCell,null,"Occupation"),c.a.createElement(w.a.HeaderCell,null,"Health Rating"))),c.a.createElement(w.a.Body,null,Object.values(t).map((function(e){return c.a.createElement(w.a.Row,{key:e.id,onClick:k(e)},c.a.createElement(w.a.Cell,null,e.name),c.a.createElement(w.a.Cell,null,e.gender),c.a.createElement(w.a.Cell,null,e.occupation),c.a.createElement(w.a.Cell,null,c.a.createElement(_,{showText:!1,rating:1})))})))),c.a.createElement(B,{modalOpen:o,onSubmit:function(e){var a,t;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(p.a.post("".concat(C.apiBaseUrl,"/patients"),e));case 3:a=r.sent,t=a.data,n(S(t)),y(),r.next=13;break;case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0.response.data),f(r.t0.response.data.error);case 13:case"end":return r.stop()}}),null,null,[[0,9]])},error:g,onClose:y}),c.a.createElement(b.a,{onClick:function(){return s(!0)}},"Add New Patient"))},P=t(78),U=t(459),J=t(452),V=t(455),W=function(e){var a,t=H(),n=Object(d.a)(t,1)[0].diagnoses,r=null===(a=e.diagnosisCodes)||void 0===a?void 0:a.map((function(e){return"".concat(e," (").concat(n[e].name,")")})).join(", ");return c.a.createElement(V.a.Content,null,c.a.createElement(V.a.Header,{as:"h3"},c.a.createElement(P.a,{name:"stethoscope"}),e.date," Hospital at ",e.specialist),c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Diagnoses:")," ",r),c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Description:")," ",e.description),e.discharge?c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Discharged")," at ",e.discharge.date,":"," ",e.discharge.criteria):null)},z=function(e){var a,t=H(),n=Object(d.a)(t,1)[0].diagnoses,r=null===(a=e.diagnosisCodes)||void 0===a?void 0:a.map((function(e){return"".concat(e," (").concat(n[e].name,")")})).join(", ");return c.a.createElement(V.a.Content,null,c.a.createElement(V.a.Header,{as:"h3"},c.a.createElement(P.a,{name:"stethoscope"}),e.date," Occupational healthcare at ",e.specialist),e.diagnosisCodes?c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Diagnoses:")," ",r):null,c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Description:")," ",e.description," ",e.sickLeave?"On sick leave from ".concat(e.sickLeave.startDate," to ").concat(e.sickLeave.endDate,"."):null),c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Employer:")," ",e.employerName))},K=function(e){return c.a.createElement(V.a.Content,null,c.a.createElement(V.a.Header,{as:"h3"},c.a.createElement(P.a,{name:"user doctor"}),e.date," Health check at ",e.specialist),c.a.createElement(V.a.Description,null,c.a.createElement("b",null,"Description:")," ",e.description),c.a.createElement(V.a.Description,null,c.a.createElement(_,{rating:e.healthCheckRating,showText:!0})))},Q=function(e){switch(e.type){case"Hospital":return c.a.createElement(W,e);case"OccupationalHealthcare":return c.a.createElement(z,e);case"HealthCheck":return c.a.createElement(K,e);default:return function(e){throw new Error("Unhandled discriminated union member: ".concat(JSON.stringify(e)))}(e)}},X=function(e){var a=e.entries;return c.a.createElement(V.a.Group,null,a.map((function(e){return c.a.createElement("div",{key:e.id},c.a.createElement(V.a,null,c.a.createElement(Q,e)),c.a.createElement(f.a,null))})))},Z=t(449),$=t(441),ee=function(e){return Boolean(Date.parse(e))},ae=function(e){return 0===Object.keys(e).length},te=function(e){var a={},t="This field is required.";if(e.date||(a.date=t),ee(e.date)||(a.date="Date is incorrect."),e.specialist||(a.specialist=t),e.description||(a.description=t),e.type||(a.type="Choose one of the options."),!e.type)return a;if("HealthCheck"===e.type&&(void 0===e.healthCheckRating?a.healthCheckRating=t:Object.values(r).includes(e.healthCheckRating)||(a.healthCheckRating="Rating is incorrect (select 0, 1, 2, 3).")),"Hospital"===e.type){var n={};e.discharge.date?ee(e.discharge.date)||(n.date="Date is incorrect"):n.date=t,e.discharge.criteria||(n.criteria=t),ae(n)||(a.discharge=n)}if("OccupationalHealthcare"===e.type){e.employerName||(a.employerName=t);var l={};e.sickLeave.startDate&&!ee(e.sickLeave.startDate)&&(l.startDate="Date is incorrect"),e.sickLeave.endDate&&!ee(e.sickLeave.endDate)&&(l.endDate="Date is incorrect"),ae(l)||(a.sickLeave=l)}return a},ne=function(e){var a=e.date,t=e.specialist,n=e.description,r=e.type,l=e.diagnosisCodes,c=e.healthCheckRating,i=e.discharge,o=e.employerName,s=e.sickLeave;if(!ae(te(e))||""===r)return{status:"Form validation failed."};if("HealthCheck"===r)return{type:"HealthCheck",date:a,specialist:t,description:n,healthCheckRating:c};if("Hospital"===r){var u={type:"Hospital",date:a,specialist:t,description:n,discharge:i};return l&&0!==l.length&&(u.diagnosisCodes=l),u}if("OccupationalHealthcare"===r){var d={type:"OccupationalHealthcare",date:a,specialist:t,description:n,employerName:o,sickLeave:s};return l&&0!==l.length&&(d.diagnosisCodes=l),d}return{status:"Multifail, you should ne be here at all."}},re=function(e){var a=e.onCancel,t=Object(L.e)({initialValues:{date:(new Date).toISOString().slice(0,10),specialist:"",description:"",type:"",diagnosisCodes:[],healthCheckRating:r.Healthy,discharge:{date:"",criteria:""},employerName:"",sickLeave:{startDate:"",endDate:""}},validate:te,onSubmit:function(a){var t=ne(a);e.onSubmit(t)},validateOnChange:!1,validateOnBlur:!1}),n=function(){var e=H(),a=Object(d.a)(e,1)[0].diagnoses;return Object.values(a).map((function(e){return{key:e.code,text:"".concat(e.name," (").concat(e.code,")"),value:e.code}}))}(),l=JSON.stringify(ne(t.values),null,2);return c.a.createElement(T.a,{onSubmit:t.handleSubmit},c.a.createElement(g.a,{as:"h4"},"General information"),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Date"),c.a.createElement(T.a.Input,{name:"date",placeholder:"YYYY-MM-DD",onChange:t.handleChange,value:t.values.date,error:t.errors.date})),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Specialist"),c.a.createElement(T.a.Input,{name:"specialist",placeholder:"Specialist",onChange:t.handleChange,value:t.values.specialist,error:t.errors.specialist})),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Description"),c.a.createElement(T.a.Input,{name:"description",placeholder:"Description",onChange:t.handleChange,value:t.values.description,error:t.errors.description})),c.a.createElement(T.a.Group,{inline:!0},c.a.createElement("label",null,"Type of visit"),c.a.createElement(T.a.Field,{control:Z.a,label:"Health check",id:"HealthCheck",name:"type",value:"HealthCheck",onChange:t.handleChange,checked:"HealthCheck"===t.values.type,error:!!t.errors.type}),c.a.createElement(T.a.Field,{control:Z.a,label:"Hospital",id:"Hospital",name:"type",value:"Hospital",onChange:t.handleChange,checked:"Hospital"===t.values.type,error:!!t.errors.type}),c.a.createElement(T.a.Field,{control:Z.a,label:"Occupational healthcare",id:"OccupationalHealthcare",name:"type",value:"OccupationalHealthcare",onChange:t.handleChange,checked:"OccupationalHealthcare"===t.values.type,error:t.errors.type})),c.a.createElement(f.a,null),"HealthCheck"===t.values.type&&c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Health check rating"),c.a.createElement(T.a.Input,{name:"healthCheckRating",type:"number",onChange:t.handleChange,value:t.values.healthCheckRating,error:t.errors.healthCheckRating})),("Hospital"===t.values.type||"OccupationalHealthcare"===t.values.type)&&c.a.createElement(T.a.Field,null,c.a.createElement("label",null,"Diagnoses"),c.a.createElement(x.a,{id:"diagnosisCodes",name:"diagnosisCodes",fluid:!0,multiple:!0,search:!0,selection:!0,options:n,onChange:function(e,a){t.setFieldValue("diagnosisCodes",a.value)}})),"Hospital"===t.values.type&&c.a.createElement(c.a.Fragment,null,c.a.createElement(g.a,{as:"h4"},"Discharge"),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Date"),c.a.createElement(T.a.Input,{name:"discharge['date']",placeholder:"YYYY-MM-DD",onChange:t.handleChange,value:t.values.discharge.date,error:t.errors.discharge&&t.errors.discharge.date})),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Criteria"),c.a.createElement(T.a.Input,{name:"discharge['criteria']",placeholder:"Criteria",onChange:t.handleChange,value:t.values.discharge.criteria,error:t.errors.discharge&&t.errors.discharge.criteria}))),"OccupationalHealthcare"===t.values.type&&c.a.createElement(c.a.Fragment,null,c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Employer"),c.a.createElement(T.a.Input,{name:"employerName",placeholder:"Employer",onChange:t.handleChange,value:t.values.employerName,error:t.errors.employerName})),c.a.createElement(T.a.Field,{control:$.a,label:"Sick leave"}),c.a.createElement(T.a.Group,{inline:!0},c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"Start date"),c.a.createElement(T.a.Input,{name:"sickLeave['startDate']",placeholder:"YYYY-MM-DD",onChange:t.handleChange,value:t.values.sickLeave.startDate,error:t.errors.sickLeave&&t.errors.sickLeave.startDate})),c.a.createElement(T.a.Field,{required:!0},c.a.createElement("label",null,"End date"),c.a.createElement(T.a.Input,{name:"sickLeave['endDate']",placeholder:"YYYY-MM-DD",onChange:t.handleChange,value:t.values.sickLeave.endDate,error:t.errors.sickLeave&&t.errors.sickLeave.endDate})))),c.a.createElement(f.a,null),"The following JSON data will be sent to backend:",c.a.createElement(N.a,null,c.a.createElement("pre",null,l)),c.a.createElement(f.a,null),c.a.createElement(F.a,null,c.a.createElement(F.a.Column,{floated:"left",width:5},c.a.createElement(b.a,{type:"button",color:"red",onClick:a},"Cancel")),c.a.createElement(F.a.Column,{floated:"right",width:5},c.a.createElement(b.a,{type:"submit",floated:"right",color:"green"},"Add"))))},le=function(e){var a=e.modalOpen,t=e.onSubmit,n=e.onClose,r=e.error;return c.a.createElement(j.a,{open:a,onClose:n,centered:!1,closeIcon:!0},c.a.createElement(j.a.Header,null,"Add a new entry"),c.a.createElement(j.a.Content,null,r&&c.a.createElement(N.a,{inverted:!0,color:"red"},"Error: ".concat(r)),c.a.createElement(re,{onSubmit:t,onCancel:n})))},ce=function(e){switch(e.gender){case"male":return c.a.createElement(P.a,{name:"mars"});case"female":return c.a.createElement(P.a,{name:"venus"});case"other":default:return c.a.createElement(P.a,{name:"genderless"})}},ie=function(){var e=H(),a=Object(d.a)(e,2),t=a[0].patients,n=a[1],r=Object(E.g)().id,l=c.a.useState(!1),i=Object(d.a)(l,2),o=i[0],s=i[1],m=c.a.useState(),h=Object(d.a)(m,2),v=h[0],f=h[1],y=t[r];if(!y)return c.a.createElement(U.a,{active:!0,inverted:!0},c.a.createElement(J.a,{inverted:!0},"Loading"));y.ssn||function(e){var a,t,r;u.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,a="".concat(C.apiBaseUrl,"/patients/").concat(e),l.next=4,u.a.awrap(p.a.get(a));case 4:t=l.sent,r=t.data,n(S(r)),l.next=12;break;case 9:l.prev=9,l.t0=l.catch(0),console.error(l.t0);case 12:case"end":return l.stop()}}),null,null,[[0,9]])}(r);var k=function(){s(!1),f(void 0)};return c.a.createElement("div",{className:"App"},y.ssn?null:c.a.createElement(U.a,{active:!0,inverted:!0},c.a.createElement(J.a,{inverted:!0},"Loading")),c.a.createElement(g.a,{as:"h1"},y.name," ",c.a.createElement(ce,{gender:y.gender})),c.a.createElement("div",null,"ssn: ",y.ssn||"unknown"),c.a.createElement("div",null,"occupation: ",y.occupation),c.a.createElement(g.a,{as:"h2"},"Entries"),y.entries?c.a.createElement(X,{entries:y.entries}):"Waiting for data ...",c.a.createElement(le,{modalOpen:o,onSubmit:function(e){var a,t,l;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,a="".concat(C.apiBaseUrl,"/patients/").concat(r,"/entries"),c.next=4,u.a.awrap(p.a.post(a,e));case 4:t=c.sent,l=t.data,y.entries.push(l),n(S(y)),k(),c.next=15;break;case 11:c.prev=11,c.t0=c.catch(0),console.error(c.t0.response.data),f(c.t0.response.data.error);case 15:case"end":return c.stop()}}),null,null,[[0,11]])},error:v,onClose:k}),c.a.createElement(b.a,{onClick:function(){return s(!0)}},"Add new entry"))},oe=function(){var e=H(),a=Object(d.a)(e,2)[1];return c.a.useEffect((function(){p.a.get("".concat(C.apiBaseUrl,"/ping"));!function(){var e,t,n;u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e="".concat(C.apiBaseUrl,"/patients"),r.next=4,u.a.awrap(p.a.get(e));case 4:t=r.sent,n=t.data,a({type:"SET_PATIENT_LIST",payload:n}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}}),null,null,[[0,9]])}();!function(){var e,t,n;u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,e="".concat(C.apiBaseUrl,"/diagnoses"),r.next=4,u.a.awrap(p.a.get(e));case 4:t=r.sent,n=t.data,a({type:"SET_DIAGNOSIS_LIST",payload:n}),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(0),console.error(r.t0);case 12:case"end":return r.stop()}}),null,null,[[0,9]])}()}),[a]),c.a.createElement("div",{className:"App",style:{paddingTop:"3em"}},c.a.createElement(h.a,null,c.a.createElement(v.a,{text:!0},c.a.createElement(g.a,{as:"h1"},"Patientor"),c.a.createElement(b.a,{as:h.b,to:"/",primary:!0},"Home"),c.a.createElement(f.a,{hidden:!0}),c.a.createElement(E.c,null,c.a.createElement(E.a,{path:"/patients/:id"},c.a.createElement(ie,null)),c.a.createElement(E.a,{path:"/"},c.a.createElement(G,null))))))};o.a.render(c.a.createElement((function(e){var a=e.reducer,t=e.children,n=Object(l.useReducer)(a,O),r=Object(d.a)(n,2),i=r[0],o=r[1];return c.a.createElement(D.Provider,{value:[i,o]},t)}),{reducer:function(e,a){switch(a.type){case"SET_PATIENT_LIST":return Object(k.a)({},e,{patients:Object(k.a)({},a.payload.reduce((function(e,a){return Object(k.a)({},e,Object(y.a)({},a.id,a))}),{}),{},e.patients)});case"ADD_PATIENT":return Object(k.a)({},e,{patients:Object(k.a)({},e.patients,Object(y.a)({},a.payload.id,a.payload))});case"SET_DIAGNOSIS_LIST":return Object(k.a)({},e,{diagnoses:Object(k.a)({},a.payload.reduce((function(e,a){return Object(k.a)({},e,Object(y.a)({},a.code,a))}),{}),{},e.diagnoses)});default:return e}}},c.a.createElement(oe,null)),document.getElementById("root"))}},[[263,1,2]]]);
//# sourceMappingURL=main.3545ee20.chunk.js.map